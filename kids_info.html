<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®¶æ—ã‚¢ãƒ«ãƒãƒ vivi - å­ã©ã‚‚æƒ…å ±</title>
    <link rel="stylesheet" href="vivi_family_style.css">
</head>
<body>
    <div class="app-container">
        <header class="top-bar">
            <div class="header-left">
                <a href="family_member.html" class="icon-button back-button"><span class="icon">ï¼œ</span> æˆ»ã‚‹</a>
            </div>
            <div class="header-center"><h1 id="detail-title">å­ã©ã‚‚æƒ…å ±</h1></div>
            <div class="header-right">
                <button class="icon-button edit-button" id="edit-button-link">
                    <span class="icon">âœ</span> 
                </button>
                <button class="icon-button delete-button-icon" onclick="deleteKidConfirmed()">
                     <span class="icon">ğŸ—‘ï¸</span>
                </button>
            </div>
        </header>

        <main class="main-content">
            <section class="detail-section">
                <div class="detail-group">
                    <label>åå‰</label>
                    <p class="detail-value" id="kid-name"></p>
                </div>
                <div class="detail-group">
                    <label>æ€§åˆ¥</label>
                    <p class="detail-value" id="kid-gender"></p>
                </div>
                <div class="detail-group">
                    <label>èª•ç”Ÿæ—¥</label>
                    <p class="detail-value" id="kid-birthday"></p>
                </div>
                <div class="detail-group">
                    <label>å¹´é½¢</label>
                    <p class="detail-value" id="kid-age"></p>
                </div>
            </section>

            <main class="main-content">

    
                <button class="secondary-button" id="growth-record-link">
                    <span class="icon">ğŸ“ˆ</span> æˆé•·è¨˜éŒ²
                </button>
                
                <div class="form-actions delete-area" style="margin-top: 20px;">
                </div>
            </main>

        </main>

        <nav class="bottom-nav">
            <a href="top.html" class="nav-item"><span class="icon">ğŸ–¼ï¸</span>ã‚¢ãƒ«ãƒãƒ </a>
            <a href="height_measure.html" class="nav-item "><span class="icon">ğŸ“·</span>ã‚«ãƒ¡ãƒ©</a>
            <a href="family_member.html" class="nav-item active"><span class="icon">âš™ï¸</span>è¨­å®š</a>
       </nav>  

    </div>
    <div id="delete-modal" class="modal-overlay" style="display:none;">
        <div class="modal-content">
            <p id="modal-message">å­ã©ã‚‚ã®æƒ…å ±ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ</p>
            <div class="modal-buttons">
                <button class="button-yes" onclick="deleteMemberConfirmed()">ã¯ã„</button>
                <button class="button-no" onclick="hideDeleteModal()">ã„ã„ãˆ</button>
            </div>
        </div>
    </div>
 

    <script>
        // å­ã©ã‚‚ãƒ‡ãƒ¼ã‚¿å®šç¾© (æœ¬æ¥ã¯ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã‚„APIã‹ã‚‰å–å¾—ã™ã‚‹ãƒ‡ãƒ¼ã‚¿)
        const kids = {
            'a': {
                name: 'Aã¡ã‚ƒã‚“',
                title_name: 'Aã¡ã‚ƒã‚“',
                gender: 'å¥³ã®å­',
                birthday: '2021å¹´4æœˆ1æ—¥',
                age: '4æ­³10ãƒ¶æœˆ'
            },
            'b': {
                name: 'Bãã‚“',
                title_name: 'Bãã‚“',
                gender: 'ç”·ã®å­',
                birthday: '2023å¹´6æœˆ1æ—¥',
                age: '2æ­³4ãƒ¶æœˆ'
            }
        };

        // URLã‹ã‚‰ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å–å¾—
                const params = new URLSearchParams(window.location.search);
                const currentKidId = params.get('id');

        function loadKidDetail() {
            // URLã‹ã‚‰ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å–å¾—
            const params = new URLSearchParams(window.location.search);
            const kidId = params.get('id');
            const data = kids[kidId];

            if (!data) {
                // ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã®å‡¦ç†
                document.getElementById('detail-title').textContent = 'æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“';
                document.querySelector('.main-content').innerHTML = '<p style="text-align:center; margin-top: 50px;">æŒ‡å®šã•ã‚ŒãŸå­ã©ã‚‚ã®æƒ…å ±ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p>';
                return;
            }

            // 1. ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æ›´æ–°
            document.getElementById('detail-title').textContent = `å­ã©ã‚‚æƒ…å ± (${data.title_name})`;
            // ç·¨é›†ãƒªãƒ³ã‚¯ã‚’æ›´æ–° (kids_add.html?edit=a or b)
            document.getElementById('edit-button-link').onclick = () => {
                location.href = `kids_edit.html?edit=${kidId}`;
            };

            // 2. è©³ç´°æƒ…å ±ã‚’æ›´æ–°
            document.getElementById('kid-name').textContent = data.name;
            document.getElementById('kid-gender').textContent = data.gender;
            document.getElementById('kid-birthday').textContent = data.birthday;
            document.getElementById('kid-age').textContent = data.age;

            // 3. æˆé•·è¨˜éŒ²ãƒªãƒ³ã‚¯ã‚’æ›´æ–°
            document.getElementById('growth-record-link').onclick = () => {
                location.href = `growth_view.html?kid=${kidId}`;
            };
        }

        /**
         * å­ã©ã‚‚æƒ…å ±å‰Šé™¤ã®ç¢ºèªã¨å®Ÿè¡Œ
         */
         function showDeleteModal(memberName, memberId) {
            memberToDeleteId = memberId;
            document.getElementById('modal-message').textContent = `å­ã©ã‚‚ã®æƒ…å ±ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`;
            document.getElementById('delete-modal').style.display = 'flex';
        }

        function hideDeleteModal() {
            memberToDeleteId = null;
            document.getElementById('delete-modal').style.display = 'none';
        }

        function deleteMemberConfirmed() {
            if (memberToDeleteId) {
                const memberElement = document.querySelector(`.member-item > .delete-icon[onclick$="'${memberToDeleteId}')"]`).closest('.member-item');
                if (memberElement) memberElement.remove();
                //alert(`ID ${memberToDeleteId} ã®å­ã©ã‚‚ã®æƒ…å ±ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚`);
            }
            hideDeleteModal(); 
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«å®Ÿè¡Œ
        loadKidDetail();
    </script>
</body>
</html>
