<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®¶æ—ã‚¢ãƒ«ãƒãƒ vivi - å­ã©ã‚‚æƒ…å ±ç·¨é›†</title>
    <link rel="stylesheet" href="vivi_family_style.css">
</head>
<body>
    <div class="app-container">
        <header class="top-bar">
            <div class="header-left">
                <button class="icon-button cancel-button" onclick="showCancelModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
            </div>
            <div class="header-center"><h1>å­ã©ã‚‚æƒ…å ±ç·¨é›†</h1></div>
            <div class="header-right">
            </div>
            <div class="header-right">
            </div>
        </header>

        <main class="main-content form-page">
            <form id="edit-family-form" onsubmit="handleEdit(event)">
                <div class="form-group">
                    <label for="kid-name">åå‰ <span class="required">*</span></label>
                    <input type="text" id="kid-name" name="name" required placeholder="ä¾‹: å±±ç”° èŠ±å­">
                </div>
                
                <div class="form-group">
                    <label for="kid-gender">æ€§åˆ¥ <span class="required">*</span></label>
                    <select id="kid-gender" name="gender" required>
                        <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                        <option value="female">å¥³ã®å­</option>
                        <option value="male">ç”·ã®å­</option>
                    </select>
                </div>

                <div class="form-group">
                     <label for="kid-birthday">èª•ç”Ÿæ—¥ <span class="required">*</span></label>
                     <input type="text" id="kid-birthday" name="birthday" required 
                               placeholder="å¹´/æœˆ/æ—¥" 
                               onfocus="this.type='date'" 
                               onblur="if(!this.value) this.type='text'">
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="primary-button large-button">å®Œäº†</button>
                    </div>
            </form>
        </main>
        <nav class="bottom-nav">
             <a href="top.html" class="nav-item"><span class="icon">ğŸ–¼ï¸</span>ã‚¢ãƒ«ãƒãƒ </a>
             <a href="height_measure.html" class="nav-item "><span class="icon">ğŸ“·</span>ã‚«ãƒ¡ãƒ©</a>
             <a href="family_member.html" class="nav-item active"><span class="icon">ğŸ‘ª</span>å®¶æ—</a>
        </nav>  
    </div>

  

    <div id="cancel-modal" class="modal-overlay" style="display:none;">
        <div class="modal-content">
            <p id="cancel-modal-message">ç·¨é›†ã‚’ä¸­æ­¢ã—ã¾ã™ã‹ï¼Ÿ</p>
            <div class="modal-buttons">

                <button class="button-yes" onclick="cancelEditConfirmed()">ã¯ã„</button>
                <button class="button-no" onclick="hideCancelModal()">ã„ã„ãˆ</button>

             </div>
        </div>
    </div>
    

    <script>
        // ğŸ’¡ ä¿®æ­£: URLã‹ã‚‰IDã‚’å–å¾—ã—ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ã‚³ãƒ¼ãƒ—ã§åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹
        const urlParams = new URLSearchParams(window.location.search);
        const currentKidId = urlParams.get('id');

        // å­ã©ã‚‚ãƒ‡ãƒ¼ã‚¿ï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ï¼‰
        const kids = {
            'a': { name: 'Aã¡ã‚ƒã‚“', gender: 'female', birthday: '2021-04-01' },
            'b': { name: 'Bãã‚“', gender: 'male', birthday: '2023-06-01' }
        };

        function showCancelModal() {
            document.getElementById('cancel-modal').style.display = 'flex';
        }

        function hideCancelModal() {
            // ã€Œã„ã„ãˆã€ã‚’æŠ¼ä¸‹ã—ãŸå ´åˆã€ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
            document.getElementById('cancel-modal').style.display = 'none';
        }

        function cancelEditConfirmed() {
            // ã€Œã¯ã„ã€ã‚’æŠ¼ä¸‹ã—ãŸå ´åˆã€å®¶æ—ãƒ¡ãƒ³ãƒãƒ¼ç”»é¢ã«é·ç§»
            // ğŸ’¡ ä¿®æ­£: å®¶æ—ãƒ¡ãƒ³ãƒãƒ¼ç”»é¢ã«é·ç§»ã—ã€tab=kidã‚’ä»˜ä¸
        location.href = 'family_member.html?tab=kid';
        }
        
// kids_edit.html ã® handleEdit é–¢æ•°
function handleEdit(event) {
    event.preventDefault(); 
    const form = document.getElementById('edit-family-form');

    if (!form.checkValidity()) {
        console.log("å¿…é ˆé …ç›®ãŒæœªå…¥åŠ›ã§ã™ã€‚");
        return; 
    }
    
    // ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰æœ€æ–°ã®å€¤ã‚’å–å¾—
    const name = form.elements['kid-name'].value;
    const gender = form.elements['kid-gender'].value;
    const birthday = form.elements['kid-birthday'].value;
    
    // ãƒ‡ãƒ¼ã‚¿ã‚’URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦ç¢ºèªç”»é¢ã«æ¸¡ã™
    const params = new URLSearchParams({
        id: currentKidId, // ç·¨é›†å¯¾è±¡ã®IDã‚‚å¿˜ã‚Œãšã«æ¸¡ã™
        name: name,
        gender: gender,
        birthday: birthday
    });

    // ç¢ºèªç”»é¢ã«é·ç§»
    location.href = `kids_edit_confirmation.html?${params.toString()}`;

    // ğŸ’¡ ä»¥å‰ã®ã‚³ãƒ¼ãƒ‰ï¼ˆå‰Šé™¤ã¾ãŸã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆï¼‰
    // console.log(`å­ã©ã‚‚ã®æƒ…å ± (ID: ${currentKidId}) ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚`);
    // location.href = 'family_member.html?tab=kid';
}
        
        /**
         * ãƒ•ã‚©ãƒ¼ãƒ ã®åˆæœŸå€¤ã‚’è¨­å®šã™ã‚‹å‡¦ç†
         */
        function loadKidData() {
            const data = kids[currentKidId];
            if (!data) {
                 // IDãŒãªã„ã€ã¾ãŸã¯ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºãªã©ãŒæœ›ã¾ã—ã„
                 console.error('æŒ‡å®šã•ã‚ŒãŸIDã®å­ã©ã‚‚ã®æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚');
                 return;
            }

            // ãƒ•ã‚©ãƒ¼ãƒ ã«ãƒ‡ãƒ¼ã‚¿ã‚’ã‚»ãƒƒãƒˆ
            document.getElementById('kid-name').value = data.name;
            document.getElementById('kid-gender').value = data.gender;
            
            // æ—¥ä»˜å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å€¤ã‚’è¨­å®š
            const birthdayInput = document.getElementById('kid-birthday');
            birthdayInput.type = 'date'; // typeã‚’dateã«å¤‰æ›´ã—ã¦å€¤ã‚’è¨­å®š
            birthdayInput.value = data.birthday; 
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«å®Ÿè¡Œ
        document.addEventListener('DOMContentLoaded', loadKidData);
    </script>
</body>
</html>
