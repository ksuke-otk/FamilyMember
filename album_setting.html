<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®¶æ—ã‚¢ãƒ«ãƒãƒ vivi - ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­å®š</title>
    <link rel="stylesheet" href="vivi_family_style.css"> 
    <style>
        /* ã“ã®ãƒšãƒ¼ã‚¸ç‰¹æœ‰ã®èª¿æ•´ã‚¹ã‚¿ã‚¤ãƒ« */
        .action-link {
            cursor: pointer;
            user-select: none;
        }
        /* ç®¡ç†è€…ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®å±•é–‹ã‚¨ãƒªã‚¢ */
        #admin-section-container {
            display: none; /* åˆæœŸçŠ¶æ…‹ã¯éè¡¨ç¤º */
            padding: 10px 0 20px 0;
            animation: slideDown 0.3s ease-out;
        }
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* ãƒªã‚¹ãƒˆã‚¢ã‚¤ãƒ†ãƒ ã®ã‚¹ã‚¿ã‚¤ãƒ«èª¿æ•´ */
        .admin-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #eee;
        }
        .admin-info {
            display: flex;
            flex-direction: column;
        }
        .admin-name {
            font-weight: bold;
            color: var(--text-color);
        }
        .admin-email {
            font-size: 0.85em;
            color: #888;
        }
        .self-badge {
            font-size: 0.75em;
            background-color: #e2e8f0;
            color: #64748b;
            padding: 2px 6px;
            border-radius: 4px;
            margin-left: 5px;
        }
        /* ğŸ’¡ ä¿®æ­£ç®‡æ‰€: ç®¡ç†è€…ä¸€è¦§å†…ã®å‰Šé™¤ãƒœã‚¿ãƒ³ã®ä½ç½®èª¿æ•´ */
        /* vivi_family_style.css ã§ .delete-icon ã« position: absolute ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã®ã‚’æ‰“ã¡æ¶ˆã™ */
        .admin-item .delete-icon {
            position: static; /* çµ¶å¯¾é…ç½®ã‚’è§£é™¤ */
            transform: none; /* ä¸­å¤®å¯„ã›å¤‰å½¢ã‚’è§£é™¤ */
            margin-left: 10px; /* å·¦å´ã«å°‘ã—ä½™ç™½ */
            color: var(--light-gray);
            cursor: pointer;
            font-size: 1.2em;
            border: none;
            background: none;
        }
        .admin-item .delete-icon:hover {
            color: var(--danger-color);
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="top-bar">
            <div class="header-left">
                <a href="top.html" class="icon-button back-button"><span class="icon">ï¼œ</span> æˆ»ã‚‹</a>
            </div> 
            <div class="header-center"><h1>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­å®š</h1></div>
            <div class="header-right"></div>
        </header>

        <main class="main-content">
            <section class="detail-section" style="margin-bottom: 30px;">
                <h2 class="section-title">ã‚ãªãŸã®æƒ…å ±</h2>
                
                <div class="detail-group">
                    <label>åå‰</label>
                    <p class="detail-value" id="current-user-name">ç§ã®åå‰ (å±±ç”° å¤ªéƒ)</p>
                </div>
                
                <div class="detail-group">
                    <label>æœ¬äººã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
                    <p class="detail-value" id="current-user-email">my.email@vivi-album.com</p>
                </div>

                <div class="detail-group">
                    <label>ç¾åœ¨ã®æ¨©é™</label>
                    <p class="detail-value permission-admin" id="current-user-permission">ç®¡ç†è€…</p>
                </div>

                <div class="detail-group">
                    <label>é–¢ä¿‚æ€§</label>
                    <p class="detail-value" id="current-user-relation">çˆ¶</p>
                </div>
            </section>
            
            <hr style="border: none; border-top: 1px solid var(--border-color); margin: 25px 0;">

            <div class="settings-action-list">
                
                <div class="action-link" onclick="toggleAdminSection()">
                    <span>ç®¡ç†è€…è¨­å®š</span>
                    <span id="admin-toggle-icon" class="icon">âˆ¨</span>
                </div>

                <div id="admin-section-container">
                    <button class="primary-button" onclick="showAddAdminModal()" style="width: 100%; margin-bottom: 15px;">
                        <span class="icon">ï¼‹</span> æ–°ã—ã„ç®¡ç†è€…ã‚’è¿½åŠ 
                    </button>

                    <div id="admin-list">
                        </div>
                </div>
                
                <a href="#" class="action-link" onclick="alert('ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´ç”»é¢ã¸é·ç§»')">
                    ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹ <span class="icon">âˆ¨</span>
                </a>

                <button class="logout-link-button" onclick="location.href='logout.html'">
                    ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
                </button>
                
            </div>
            
        </main>

        <div id="add-admin-modal" class="modal-overlay" style="display:none;">
            <div class="modal-content">
                <h2 class="section-title" style="margin-bottom:15px; text-align:center;">ç®¡ç†è€…ã‚’è¿½åŠ </h2>
                <form onsubmit="handleAddAdmin(event)">
                    <div class="form-group">
                        <label>åå‰ <span class="required">*</span></label>
                        <input type="text" id="new-admin-name" required placeholder="ä¾‹: ä½è—¤ èŠ±å­">
                    </div>
                    <div class="form-group">
                        <label>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ <span class="required">*</span></label>
                        <input type="email" id="new-admin-email" required placeholder="mail@example.com">
                    </div>
                    <div class="modal-buttons" style="margin-top:20px;">
                        <button type="button" class="button-no" onclick="hideAddAdminModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                        <button type="submit" class="button-yes">è¿½åŠ </button>
                    </div>
                </form>
            </div>
        </div>

        <div id="delete-admin-modal" class="modal-overlay" style="display:none;">
            <div class="modal-content">
                <p id="delete-modal-message" style="text-align:center; margin-bottom:20px;">ã“ã®ç®¡ç†è€…ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ</p>
                <div class="modal-buttons">
                    <button class="button-no" onclick="hideDeleteAdminModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                    <button class="button-yes danger-button" onclick="deleteAdminConfirmed()" style="background-color:var(--danger-color); color:white;">å‰Šé™¤</button>
                </div>
            </div>
        </div>

        <nav class="bottom-nav">
            <a href="top.html" class="nav-item active"><span class="icon">ğŸ–¼ï¸</span>ã‚¢ãƒ«ãƒãƒ </a>
            <a href="height_measure.html" class="nav-item"><span class="icon">ğŸ“·</span>ã‚«ãƒ¡ãƒ©</a>
            <a href="family_member.html" class="nav-item"><span class="icon">ğŸ‘ª</span>å®¶æ—</a>
        </nav>
    </div>

    <script>
        // ---------------------------------------------------------
        // ãƒ‡ãƒ¼ã‚¿å®šç¾© (ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨)
        // ---------------------------------------------------------
        const currentUser = {
            id: 'admin1',
            name: 'ç§ã®åå‰ (å±±ç”° å¤ªéƒ)',
            email: 'my.email@vivi-album.com',
            permission: 'ç®¡ç†è€…',
            relation: 'çˆ¶'
        };

        // ç®¡ç†è€…ä¸€è¦§ãƒ‡ãƒ¼ã‚¿
        let adminList = [
            { id: 'admin1', name: 'ç§ã®åå‰', email: 'my.email@vivi-album.com', isSelf: true },
            { id: 'admin2', name: 'å¦»ã®åå‰', email: 'wife@example.com', isSelf: false },
            { id: 'admin3', name: 'ç¥–çˆ¶', email: 'grandpa@example.com', isSelf: false }
        ];

        let deleteTargetId = null; // å‰Šé™¤å¯¾è±¡ã®ä¸€æ™‚ä¿æŒç”¨

        // ---------------------------------------------------------
        // åˆæœŸè¡¨ç¤ºå‡¦ç†
        // ---------------------------------------------------------
        document.addEventListener('DOMContentLoaded', () => {
            // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã®è¡¨ç¤º
            document.getElementById('current-user-name').textContent = currentUser.name;
            document.getElementById('current-user-email').textContent = currentUser.email;
            document.getElementById('current-user-relation').textContent = currentUser.relation;
            
            const permElem = document.getElementById('current-user-permission');
            permElem.textContent = currentUser.permission;
            if (currentUser.permission === 'ç®¡ç†è€…') {
                permElem.classList.add('permission-admin');
            } else {
                permElem.classList.add('permission-post');
            }

            // ç®¡ç†è€…ãƒªã‚¹ãƒˆã®æç”»
            renderAdminList();
        });

        // ---------------------------------------------------------
        // ç®¡ç†è€…ãƒªã‚¹ãƒˆã®è¡¨ç¤ºãƒ»éè¡¨ç¤º (ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³)
        // ---------------------------------------------------------
        function toggleAdminSection() {
            const section = document.getElementById('admin-section-container');
            const icon = document.getElementById('admin-toggle-icon');
            
            if (section.style.display === 'block') {
                section.style.display = 'none';
                icon.textContent = 'âˆ¨'; // é–‰ã˜ãŸçŠ¶æ…‹
            } else {
                section.style.display = 'block';
                icon.textContent = 'âˆ§'; // é–‹ã„ãŸçŠ¶æ…‹
            }
        }

        // ---------------------------------------------------------
        // ç®¡ç†è€…ãƒªã‚¹ãƒˆæç”»ãƒ­ã‚¸ãƒƒã‚¯
        // ---------------------------------------------------------
        function renderAdminList() {
            const container = document.getElementById('admin-list');
            container.innerHTML = '';

            adminList.forEach(admin => {
                const item = document.createElement('div');
                item.className = 'admin-item';
                
                // è‡ªåˆ†è‡ªèº«ã‹ã©ã†ã‹ã§è¡¨ç¤ºã‚’å¤‰ãˆã‚‹
                const nameDisplay = admin.isSelf 
                    ? `<span class="admin-name">${admin.name}</span><span class="self-badge">ã‚ãªãŸ</span>` 
                    : `<span class="admin-name">${admin.name}</span>`;
                
                const deleteButton = admin.isSelf 
                    ? '' // è‡ªåˆ†ã¯å‰Šé™¤ã§ããªã„
                    : `<button class="icon-button delete-icon" onclick="showDeleteAdminModal('${admin.id}', '${admin.name}')">ğŸ—‘ï¸</button>`;

                item.innerHTML = `
                    <div class="admin-info">
                        <div>${nameDisplay}</div>
                        <span class="admin-email">${admin.email}</span>
                    </div>
                    <div>
                        ${deleteButton}
                    </div>
                `;
                container.appendChild(item);
            });
        }

        // ---------------------------------------------------------
        // è¿½åŠ æ©Ÿèƒ½ (ãƒ¢ãƒ¼ãƒ€ãƒ«åˆ¶å¾¡)
        // ---------------------------------------------------------
        function showAddAdminModal() {
            // ãƒ•ã‚©ãƒ¼ãƒ ã®ãƒªã‚»ãƒƒãƒˆ
            document.getElementById('new-admin-name').value = '';
            document.getElementById('new-admin-email').value = '';
            document.getElementById('add-admin-modal').style.display = 'flex';
        }

        function hideAddAdminModal() {
            document.getElementById('add-admin-modal').style.display = 'none';
        }

        function handleAddAdmin(event) {
            event.preventDefault();
            const name = document.getElementById('new-admin-name').value;
            const email = document.getElementById('new-admin-email').value;

            // æ–°è¦ç®¡ç†è€…ã‚’è¿½åŠ  (ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³)
            const newAdmin = {
                id: 'admin' + Date.now(),
                name: name,
                email: email,
                isSelf: false
            };
            adminList.push(newAdmin);

            // ãƒªã‚¹ãƒˆå†æç”»
            renderAdminList();
            hideAddAdminModal();
            // alert(`${name} ã•ã‚“ã‚’ç®¡ç†è€…ã«è¿½åŠ ã—ã¾ã—ãŸã€‚`);
        }

        // ---------------------------------------------------------
        // å‰Šé™¤æ©Ÿèƒ½ (ãƒ¢ãƒ¼ãƒ€ãƒ«åˆ¶å¾¡)
        // ---------------------------------------------------------
        function showDeleteAdminModal(id, name) {
            deleteTargetId = id;
            document.getElementById('delete-modal-message').textContent = `${name} ã•ã‚“ã‚’ç®¡ç†è€…ã‹ã‚‰å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`;
            document.getElementById('delete-admin-modal').style.display = 'flex';
        }

        function hideDeleteAdminModal() {
            deleteTargetId = null;
            document.getElementById('delete-admin-modal').style.display = 'none';
        }

        function deleteAdminConfirmed() {
            if (deleteTargetId) {
                // é…åˆ—ã‹ã‚‰å‰Šé™¤
                adminList = adminList.filter(admin => admin.id !== deleteTargetId);
                renderAdminList();
            }
            hideDeleteAdminModal();
        }
    </script>
</body>
</html>
