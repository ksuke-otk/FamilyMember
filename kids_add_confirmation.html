<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®¶æ—ã‚¢ãƒ«ãƒãƒ vivi - å­ã©ã‚‚ç™»éŒ²ç¢ºèª</title>
    <link rel="stylesheet" href="vivi_family_style.css"> 
</head>
<body>
    <div class="app-container">
        <header class="top-bar">
            <div class="header-left">

            </div>                 
                <div class="header-center"><h1>å­ã©ã‚‚ç™»éŒ²ç¢ºèª</h1></div>
            <div class="header-right">
            </div>
        </header>

        <main class="main-content form-page">
            <p class="form-instruction">ä»¥ä¸‹ã®å†…å®¹ã§å­ã©ã‚‚ã‚’ç™»éŒ²ã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ</p>

            <section class="confirm-section">
                <div class="detail-group">
                    <label>åå‰</label>
                    <p class="detail-value" id="confirm-name"></p>
                </div>
                
                <div class="detail-group">
                    <label>æ€§åˆ¥</label>
                    <p class="detail-value" id="confirm-gender"></p>
                </div>
                
                <div class="detail-group">
                    <label>èª•ç”Ÿæ—¥</label>
                    <p class="detail-value" id="confirm-birthday"></p>
                </div>
            </section>
            
            <div class="confirm-button-group">
                <button type="button" class="primary-button large-button" onclick="handleRegistration()">ç™»éŒ²å®Œäº†</button>
                
                <button type="button" id="back-to-edit" class="secondary-button large-button" onclick="goToEditPage()" style="margin-top: 15px;">
                    <span class="icon"></span> ä¿®æ­£ã™ã‚‹
                </button> 
            </div>
            
        </main>

        <nav class="bottom-nav">
            <a href="top.html" class="nav-item"><span class="icon">ğŸ–¼ï¸</span>ã‚¢ãƒ«ãƒãƒ </a>
            <a href="height_measure.html" class="nav-item"><span class="icon">ğŸ“·</span>ã‚«ãƒ¡ãƒ©</a>
            <a href="family_member.html" class="nav-item active"><span class="icon">ğŸ‘ª</span>å®¶æ—</a>
        </nav> 
    </div>
    
    <script>

        // æ€§åˆ¥ã®å€¤ã‚’æ—¥æœ¬èªã«å¤‰æ›ã™ã‚‹ãƒãƒƒãƒ— (ç¢ºèªç”»é¢è¡¨ç¤ºç”¨)
        const genderMap = {
            'boy': 'ç”·ã®å­',
            'girl': 'å¥³ã®å­',
            'other': 'ãã®ä»–'
        };

        let kidData = {}; // ç™»éŒ²ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ

        /**
         * ä¿®æ­£ãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã®å‡¦ç† (kids_add.htmlã¸ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã—ã¦æˆ»ã‚‹)
         */
         function goToEditPage() {
            // kidDataã¯loadConfirmationDataã§æ—¢ã«ã‚»ãƒƒãƒˆã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’å‰æã¨ã™ã‚‹
            if (kidData.name !== undefined) {
                const name = kidData.name;
                const genderValue = kidData.gender;
                const birthday = kidData.birthday;

                // kids_add.html ã«ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦æ¸¡ã—ã€é·ç§»ã™ã‚‹
                location.href = `kids_add.html?name=${encodeURIComponent(name)}&gender=${genderValue}&birthday=${birthday}`;
            } else {
                // ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã¯ã€å˜ã« kids_add.html ã«æˆ»ã‚‹
                location.href = 'kids_add.html';
            }
        }

        /**
         * URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€ç”»é¢ã«è¡¨ç¤º
         */
        function loadConfirmationData() {
            const params = new URLSearchParams(window.location.search);
            const name = params.get('name') || 'ï¼ˆæœªå…¥åŠ›ï¼‰';
            const genderValue = params.get('gender') || '';
            const birthday = params.get('birthday') || 'ï¼ˆæœªå…¥åŠ›ï¼‰';
            
            // ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒ
            kidData = { name, gender: genderValue, birthday };

            // ä¿®æ­£ãƒœã‚¿ãƒ³ã®ãƒªãƒ³ã‚¯ã‚’ã€å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’æŒãŸã›ã¦å‰ã®ç”»é¢ã«æˆ»ã™ã‚ˆã†ã«è¨­å®š
            /*document.getElementById('back-to-edit').href = 
                `kids_add.html?name=${encodeURIComponent(name)}&gender=${genderValue}&birthday=${birthday}`;
             */
            // ç”»é¢è¡¨ç¤º
            document.getElementById('confirm-name').textContent = name;
            document.getElementById('confirm-gender').textContent = genderMap[genderValue] || genderValue || 'ï¼ˆæœªé¸æŠï¼‰';
            document.getElementById('confirm-birthday').textContent = birthday;
        }

        /**
         * ç™»éŒ²å®Œäº†ãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã®å‡¦ç† (æœ€çµ‚ç™»éŒ²å‡¦ç†)
         * ğŸ’¡ å…ƒã€… kids_add.html ã«ã‚ã£ãŸãƒ­ã‚¸ãƒƒã‚¯ã‚’ã“ã“ã«ç§»å‹•ã—ã¾ã—ãŸã€‚
         */
        function handleRegistration() {
            // ç™»éŒ²å‡¦ç†ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆå®Ÿéš›ã¯ã“ã“ã§APIã‚³ãƒ¼ãƒ«ãªã©ãŒè¡Œã‚ã‚Œã¾ã™ï¼‰
            console.log(`å­ã©ã‚‚ã‚’ç™»éŒ²ã—ã¾ã—ãŸ: åå‰=${kidData.name}, æ€§åˆ¥=${kidData.gender}, èª•ç”Ÿæ—¥=${kidData.birthday}`);
            
           // alert(`${kidData.name} ã¡ã‚ƒã‚“/ãã‚“ã‚’ã‚¢ãƒ«ãƒãƒ ã«ç™»éŒ²ã—ã¾ã—ãŸã€‚`); 
            
            // å®¶æ—ãƒ¡ãƒ³ãƒãƒ¼ç”»é¢ã«é·ç§»ã—ã€å­ã©ã‚‚ã‚¿ãƒ–ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ã™ã‚‹
            location.href = 'family_member.html?tab=kid';
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«å®Ÿè¡Œ
        document.addEventListener('DOMContentLoaded', loadConfirmationData);
    </script>
</body>
</html>