<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®¶æ—ã‚¢ãƒ«ãƒãƒ vivi - å­ã©ã‚‚æƒ…å ±ç·¨é›†ç¢ºèª</title>
    <link rel="stylesheet" href="vivi_family_style.css"> 
</head>
<body>
    <div class="app-container">
        <header class="top-bar">
            <div class="header-left">
                </div>                 
                <div class="header-center"><h1>å­ã©ã‚‚æƒ…å ±ç·¨é›†ç¢ºèª</h1></div>
            <div class="header-right">
            </div>
        </header>

        <main class="main-content form-page">
            <p class="form-instruction">ä»¥ä¸‹ã®å†…å®¹ã«**ç·¨é›†**ã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ</p>

            <section class="confirm-section">
                <div class="detail-group">
                    <label>åå‰</label>
                    <p class="detail-value" id="confirm-name">ï¼ˆè¡¨ç¤ºã‚¨ãƒªã‚¢ï¼‰</p>
                </div>
                
                <div class="detail-group">
                    <label>æ€§åˆ¥</label>
                    <p class="detail-value" id="confirm-gender">ï¼ˆè¡¨ç¤ºã‚¨ãƒªã‚¢ï¼‰</p>
                </div>
                
                <div class="detail-group">
                    <label>èª•ç”Ÿæ—¥</label>
                    <p class="detail-value" id="confirm-birthday">ï¼ˆè¡¨ç¤ºã‚¨ãƒªã‚¢ï¼‰</p>
                </div>
            </section>
            
            <div class="form-actions">
                <button type="button" class="primary-button large-button" onclick="handleRegistration()">
                    ç™»éŒ²å®Œäº†
                </button>
                <button type="button" id="back-to-edit" class="secondary-button large-button" onclick="goToEditPage()" style="margin-top: 15px;">
                    <span class="icon"></span> ä¿®æ­£ã™ã‚‹
                </button> 
                </div>
            </div>
        </main>

        <nav class="bottom-nav">
            <a href="top.html" class="nav-item"><span class="icon">ğŸ–¼ï¸</span>ã‚¢ãƒ«ãƒãƒ </a>
            <a href="height_measure.html" class="nav-item"><span class="icon">ğŸ“·</span>ã‚«ãƒ¡ãƒ©</a>
            <a href="family_member.html" class="nav-item active"><span class="icon">ğŸ‘ª</span>å®¶æ—</a>
        </nav>
    </div>

    <script>
        let kidData = {}; // ç·¨é›†ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã™ã‚‹ãŸã‚ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let currentKidId = ''; // ç·¨é›†å¯¾è±¡ã®å­ã©ã‚‚ã®ID

        // æ€§åˆ¥ã®å€¤ã‚’è¡¨ç¤ºç”¨ã®ãƒ†ã‚­ã‚¹ãƒˆã«å¤‰æ›ã™ã‚‹ãƒãƒƒãƒ—
        const genderMap = {
            'female': 'å¥³ã®å­',
            'male': 'ç”·ã®å­'
        };

        /**
         * URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€ç”»é¢ã«è¡¨ç¤ºã™ã‚‹
         */
        function loadConfirmationData() {
            const params = new URLSearchParams(window.location.search);
            
            // ç·¨é›†ç”»é¢ã‹ã‚‰æ¸¡ã•ã‚Œã‚‹æƒ…å ±
            currentKidId = params.get('id') || '';
            const name = params.get('name') || 'ï¼ˆæœªå…¥åŠ›ï¼‰';
            const genderValue = params.get('gender') || '';
            const birthday = params.get('birthday') || 'ï¼ˆæœªå…¥åŠ›ï¼‰';
            
            // ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒ
            kidData = { id: currentKidId, name, gender: genderValue, birthday };

            // ä¿®æ­£ãƒœã‚¿ãƒ³ã®ãƒªãƒ³ã‚¯ã‚’ã€å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’æŒãŸã›ã¦å‰ã®ç”»é¢ã«æˆ»ã™ã‚ˆã†ã«è¨­å®š
            document.getElementById('back-to-edit').href = 
                `kids_edit.html?id=${currentKidId}&name=${encodeURIComponent(name)}&gender=${genderValue}&birthday=${birthday}`;
             
            // ç”»é¢è¡¨ç¤º
            document.getElementById('confirm-name').textContent = name;
            document.getElementById('confirm-gender').textContent = genderMap[genderValue] || genderValue || 'ï¼ˆæœªé¸æŠï¼‰';
            document.getElementById('confirm-birthday').textContent = birthday;
        }

        /**
         * ä¿®æ­£ãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã®å‡¦ç† (kids_edit.htmlã¸ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã—ã¦æˆ»ã‚‹)
         */
         function goToEditPage() {
            // kidDataã¯loadConfirmationDataã§æ—¢ã«ã‚»ãƒƒãƒˆã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’å‰æã¨ã™ã‚‹
            if (kidData.name !== undefined) {
                const name = kidData.name;
                const genderValue = kidData.gender;
                const birthday = kidData.birthday;

                // kids_add.html ã«ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦æ¸¡ã—ã€é·ç§»ã™ã‚‹
                location.href = `kids_edit.html?name=${encodeURIComponent(name)}&gender=${genderValue}&birthday=${birthday}`;
            } else {
                // ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã¯ã€å˜ã« kids_add.html ã«æˆ»ã‚‹
                location.href = 'kids_edit.html';
            }
        }

        /**
         * ç™»éŒ²å®Œäº†ãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã®å‡¦ç† (æœ€çµ‚ç™»éŒ²/ç·¨é›†å‡¦ç†)
         */
        function handleRegistration() {
            // ç·¨é›†å‡¦ç†ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆå®Ÿéš›ã¯ã“ã“ã§APIã‚³ãƒ¼ãƒ«ãªã©ãŒè¡Œã‚ã‚Œã¾ã™ï¼‰
            console.log(`å­ã©ã‚‚ã®æƒ…å ± (ID: ${kidData.id}) ã‚’ç·¨é›†ã—ã¾ã—ãŸ: åå‰=${kidData.name}, æ€§åˆ¥=${kidData.gender}, èª•ç”Ÿæ—¥=${kidData.birthday}`);
            
            // ç·¨é›†å®Œäº†å¾Œã€å®¶æ—ãƒ¡ãƒ³ãƒãƒ¼ç”»é¢ã«é·ç§»ã—ã€å­ã©ã‚‚ã‚¿ãƒ–ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ã™ã‚‹
            location.href = 'family_member.html?tab=kid';
        }

        // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã«å®Ÿè¡Œ
        document.addEventListener('DOMContentLoaded', loadConfirmationData);
    </script>
</body>
</html>
